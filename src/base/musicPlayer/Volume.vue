<template>
    <span
        class="volume-container"
        @mouseover="show = true"
        @mouseout="show = false"
    >
        <svg
            t="1594970038952"
            class="icon"
            viewBox="0 0 1024 1024"
            version="1.1"
            xmlns="http://www.w3.org/2000/svg"
            p-id="8011"
            v-if="volume === 0"
            @click="toggleMute(false)"
        >
            <path
                d="M731.428571 201.142857v621.714286c0 20.004571-16.566857 36.571429-36.571428 36.571428a36.205714 36.205714 0 0 1-25.709714-10.861714L478.866286 658.285714H329.142857c-20.004571 0-36.571429-16.566857-36.571428-36.571428v-219.428572c0-20.004571 16.566857-36.571429 36.571428-36.571428h149.723429l190.281143-190.281143A36.425143 36.425143 0 0 1 694.857143 164.571429c20.004571 0 36.571429 16.566857 36.571428 36.571428z"
                fill=""
                p-id="8012"
            ></path>
        </svg>
        <svg
            t="1594970346108"
            class="icon"
            viewBox="0 0 1024 1024"
            version="1.1"
            xmlns="http://www.w3.org/2000/svg"
            p-id="8147"
            v-else-if="volume === 1"
            @click="toggleMute(true)"
        >
            <path
                d="M475.428571 201.142857v621.714286c0 20.004571-16.566857 36.571429-36.571428 36.571428a36.205714 36.205714 0 0 1-25.709714-10.861714L222.866286 658.285714H73.142857c-20.004571 0-36.571429-16.566857-36.571428-36.571428v-219.428572c0-20.004571 16.566857-36.571429 36.571428-36.571428h149.723429l190.281143-190.281143A36.425143 36.425143 0 0 1 438.857143 164.571429c20.004571 0 36.571429 16.566857 36.571428 36.571428z m219.428572 310.857143c0 57.161143-34.852571 112.566857-88.576 134.290286a31.780571 31.780571 0 0 1-14.299429 2.852571c-20.004571 0-36.571429-16.018286-36.571428-36.571428 0-43.446857 66.304-31.414857 66.304-100.571429s-66.304-57.161143-66.304-100.571429c0-20.553143 16.566857-36.571429 36.571428-36.571428 4.571429 0 9.728 0.585143 14.299429 2.852571C660.004571 398.848 694.857143 454.838857 694.857143 512z m146.285714 0c0 116.004571-69.705143 224-177.152 269.129143a42.349714 42.349714 0 0 1-14.299428 2.852571 36.937143 36.937143 0 0 1-37.156572-36.571428c0-16.018286 9.142857-26.843429 22.272-33.718857 15.433143-8.009143 29.696-14.848 43.446857-25.161143 56.576-41.142857 89.709714-106.861714 89.709715-176.566857s-33.133714-135.424-89.709715-176.566858c-13.714286-10.276571-28.013714-17.152-43.446857-25.161142-13.129143-6.838857-22.272-17.700571-22.272-33.718858 0-20.004571 16.566857-36.571429 36.571429-36.571428 5.156571 0 10.276571 1.133714 14.848 2.852571 107.446857 45.129143 177.152 153.161143 177.152 269.129143z m146.285714 0c0 175.433143-104.557714 334.299429-265.728 403.419429a42.861714 42.861714 0 0 1-14.848 2.852571c-20.004571 0-36.571429-16.566857-36.571428-36.571429 0-16.566857 8.557714-25.709714 22.272-33.718857 8.009143-4.571429 17.152-7.424 25.709714-11.995428 16.018286-8.557714 32-18.285714 46.848-29.147429 93.696-69.156571 149.138286-178.285714 149.138286-294.838857s-55.442286-225.718857-149.138286-294.838857a402.505143 402.505143 0 0 0-46.848-29.147429c-8.557714-4.571429-17.700571-7.424-25.709714-11.995428-13.714286-8.009143-22.272-17.152-22.272-33.718857 0-20.004571 16.566857-36.571429 36.571428-36.571429 5.156571 0 10.276571 1.133714 14.848 2.852571A439.186286 439.186286 0 0 1 987.428571 512z"
                fill=""
                p-id="8148"
            ></path>
        </svg>
        <svg
            t="1594970328604"
            class="icon"
            viewBox="0 0 1024 1024"
            version="1.1"
            xmlns="http://www.w3.org/2000/svg"
            p-id="8011"
            v-else
            @click="toggleMute(true)"
        >
            <path
                d="M621.714286 201.142857v621.714286c0 20.004571-16.566857 36.571429-36.571429 36.571428a36.205714 36.205714 0 0 1-25.709714-10.861714L369.152 658.285714H219.428571c-20.004571 0-36.571429-16.566857-36.571428-36.571428v-219.428572c0-20.004571 16.566857-36.571429 36.571428-36.571428h149.723429l190.281143-190.281143A36.425143 36.425143 0 0 1 585.142857 164.571429c20.004571 0 36.571429 16.566857 36.571429 36.571428z m219.428571 310.857143c0 57.161143-34.852571 112.566857-88.576 134.290286a31.780571 31.780571 0 0 1-14.299428 2.852571c-20.004571 0-36.571429-16.018286-36.571429-36.571428 0-43.446857 66.304-31.414857 66.304-100.571429s-66.304-57.161143-66.304-100.571429c0-20.553143 16.566857-36.571429 36.571429-36.571428 4.571429 0 9.728 0.585143 14.299428 2.852571C806.290286 398.848 841.142857 454.838857 841.142857 512z"
                fill=""
                p-id="8012"
            ></path>
        </svg>
        <div class="volume-control-container" v-show="show">
            <div
                class="volume-control-inner"
                @click.stop="changeVolume($event)"
                ref="inner"
            >
                <div
                    class="volume-control-value"
                    :style="{ height: volume * 100 + '%' }"
                ></div>
            </div>
        </div>
    </span>
</template>

<script>
function getTop(e) {
    var offset = e.offsetTop
    if (e.offsetParent != null) offset += getTop(e.offsetParent)
    return offset
}
export default {
    name: 'Volume',
    data() {
        return {
            volume: 0.6,
            show: false,
        }
    },
    methods: {
        toggleMute(bool) {
            if (bool) {
                this.volume = 0
            } else {
                this.volume = 0.6
            }
        },
        changeVolume(e) {
            let containerHeight = this.$refs['inner'].offsetHeight
            let length =
                getTop(this.$refs['inner']) + containerHeight - e.pageY + 4
            this.volume = Math.floor((length / containerHeight) * 10) / 10
            if (this.$parent.player) {
                this.$parent.player.setVolume(this.volume)
            }
        },
    },
}
</script>

<style scoped lang="scss">
.volume-container {
    position: relative;
    width: 20px;
    svg {
        width: 20px;
        height: 20px;
    }
}
.volume-control-container {
    position: absolute;
    bottom: 20px;
    z-index: 100;
    width: 20px;
    height: 80px;
}
.volume-control-inner {
    position: absolute;
    left: 7px;
    top: -4px;
    width: 6px;
    height: 100%;
    background-image: linear-gradient(200deg, #7f7280, #000000);
    border-radius: 2px;
    overflow: hidden;
}
.volume-control-value {
    position: absolute;
    bottom: 0;
    width: 100%;
    background-color: #e9e9e9;
    transition: all 0.3s;
}
</style>
